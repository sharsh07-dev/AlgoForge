<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriMantra </title>
  <meta name="description" content="AgriMantra ‚Äî Voice-first farming assistant (frontend demo)." />
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#16a34a; --glass: rgba(255,255,255,0.04);
      --radius:14px; --fw-strong:600; --max-width:1080px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:linear-gradient(180deg,#071022 0%, #071826 60%); color:#e6eef6}
    .app{max-width:var(--max-width);margin:32px auto;padding:28px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow: 0 8px 30px rgba(2,6,23,0.6)}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo{width:120px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#059669);display:flex;align-items:center;justify-content:center;font-weight:700;color:white;font-size:20px;box-shadow:0 6px 20px rgba(5,150,105,0.15)}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}.sidebar{order:2}}

    /* Main card */
    .card{background:var(--card);border-radius:var(--radius);padding:20px}  #dad7cd #a3b18a

    /* Voice box */
    .voiceBox{display:flex;flex-direction:column;gap:12px}
    .controls{display:flex;gap:12px;align-items:center}
    .micBtn{width:78px;height:78px;border-radius:999px;border:none;background:linear-gradient(180deg,#ff5964,#ff2d55);display:flex;align-items:center;justify-content:center;color:white;font-size:28px;cursor:pointer;box-shadow:0 8px 30px rgba(255,45,85,0.12);transition:transform .12s ease}
    .micBtn.recording{transform:scale(1.06);box-shadow:0 12px 40px rgba(255,45,85,0.18)}
    .smallBtn{background:var(--glass);border:none;padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}

    .transcript{min-height:84px;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#d7e7f2;font-size:15px}

    /* Response area */
    .response{margin-top:14px;padding:14px;border-radius:12px;background:linear-gradient(90deg, rgba(20,38,30,0.6), rgba(12,18,24,0.4));color:#dff0e6}
    .response h3{margin:0 0 8px 0;font-size:15px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;color:var(--muted);font-size:13px}

    /* Sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .card h4{margin:0 0 8px 0}
    .weatherRow{display:flex;align-items:center;gap:12px}
    .weatherIcon{width:56px;height:56px;border-radius:10px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-size:22px}
    .list{display:flex;flex-direction:column;gap:10px}
    .scheme{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

<img src="logo.png" alt="Logo" >

    /* accessibility */
    button:focus{outline:3px solid rgba(22,163,74,0.18)}

    /* tiny helper */
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <main class="app" role="main">
    <header>
      <div class="logo">AlgoForge</div>
      <div>
      
      </div><!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriMantra ‚Äî An Personal Farming Assistant</title>
  <meta name="description" content="AgriMantra ‚Äî Voice-first farming assistant (frontend demo)." />
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#16a34a; --glass: rgba(255,255,255,0.04);
      --radius:14px; --fw-strong:600; --max-width:1080px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:linear-gradient(180deg,#071022 0%, #071826 60%); color:#e6eef6}
    .app{max-width:var(--max-width);margin:32px auto;padding:28px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow: 0 8px 30px rgba(2,6,23,0.6)}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo-img{height:60px;width:auto;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.25)}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}.sidebar{order:2}}

    /* Main card */
    .card{background:var(--card);border-radius:var(--radius);padding:20px}

    /* Voice box */
    .voiceBox{display:flex;flex-direction:column;gap:12px}
    .controls{display:flex;gap:12px;align-items:center}
    .micBtn{width:78px;height:78px;border-radius:999px;border:none;background:linear-gradient(180deg,#ff5964,#ff2d55);display:flex;align-items:center;justify-content:center;color:white;font-size:28px;cursor:pointer;box-shadow:0 8px 30px rgba(255,45,85,0.12);transition:transform .12s ease}
    .micBtn.recording{transform:scale(1.06);box-shadow:0 12px 40px rgba(255,45,85,0.18)}
    .smallBtn{background:var(--glass);border:none;padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}

    .transcript{min-height:84px;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#d7e7f2;font-size:15px}

    /* Response area */
    .response{margin-top:14px;padding:14px;border-radius:12px;background:linear-gradient(90deg, rgba(20,38,30,0.6), rgba(12,18,24,0.4));color:#dff0e6}
    .response h3{margin:0 0 8px 0;font-size:15px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;color:var(--muted);font-size:13px}

    /* Sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .card h4{margin:0 0 8px 0}
    .weatherRow{display:flex;align-items:center;gap:12px}
    .weatherIcon{width:56px;height:56px;border-radius:10px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-size:22px}
    .list{display:flex;flex-direction:column;gap:10px}
    .scheme{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

    /* accessibility */
    button:focus{outline:3px solid rgba(22,163,74,0.18)}

    /* tiny helper */
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <main class="app" role="main">
    <header>
      <img src="./img/Screenshot 2025-09-15 161121.png" alt="AgriMantra Logo" class="logo-img" />
      <div>
        <h1>AgriMantra ‚Äî An Personal Farming Assistant</h1>
        <p class="lead">Friendly, voice-first  ‚Äî supports speech input, synth, weather lookup & quick crop tips.</p>
      </div>
    </header>

    <!-- rest of the code remains same -->
    <!-- ... (the existing grid, voiceBox, sidebar, footer, and scripts are unchanged) ... -->

  </main>
</body>
</html>

    </header>

    <section class="grid" aria-label="Main content">
      <div class="card" role="region" aria-labelledby="voiceTitle">
        <div class="voiceBox">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <h2 id="voiceTitle" style="margin:0;font-size:16px">Ask AgriMantra (press mic)</h2>
              <div class="muted" style="font-size:13px;margin-top:4px">Try: "weather in Pune", "Which disease my crop has", "Any schemes available for farmer"</div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <select id="langSelect" class="smallBtn" aria-label="Choose language">
                <option value="en-IN">English</option>
                <option value="ml-IN">Malayalam</option>
                <option value="hi-IN">Hindi</option>
                <option value="hi-IN">Telgu</option>
                <option value="hi-IN">Marathi</option>
                      <option value="hi-IN">urdu</option>
              </select>
              <button id="clearBtn" class="smallBtn">Clear</button>
            </div>
          </div>

          <div class="controls">
            <button id="micBtn" class="micBtn" aria-pressed="false" title="Start/Stop recording">
              <svg id="micIcon" width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 14a3 3 0 0 0 3-3V6a3 3 0 0 0-6 0v5a3 3 0 0 0 3 3z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19 11v1a7 7 0 0 1-14 0v-1" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>

            <div style="flex:1">
              <div id="transcript" class="transcript" aria-live="polite">Press the mic and speak ‚Äî your transcript will appear here.</div>
            </div>

            <button id="playResp" class="smallBtn" title="Play response">üîä Play</button>
          </div>

          <div id="response" class="response" hidden>
            <h3>Response</h3>
            <div id="responseText">‚Äî</div>
            <div style="margin-top:12px" class="chips" id="responseChips"></div>
          </div>

        </div>
      </div>

      <aside class="sidebar">
        <div class="card">
          <h4>Weather</h4>
          <div class="weatherRow">
            <div class="weatherIcon" id="weatherIcon">‚òÄÔ∏è</div>
            <div>
              <div id="weatherPlace" style="font-weight:600">Enter location</div>
              <div id="weatherSummary" class="muted">Current conditions will show here</div>
            </div>
          </div>
          <div style="margin-top:12px;display:flex;gap:8px">
            <input id="cityInput" type="text" placeholder="City / Village" style="flex:1;padding:8px;border-radius:10px;border:none;background:rgba(255,255,255,0.02);color:inherit" />
            <button id="getWeather" class="smallBtn">Get</button>
          </div>
        </div>

        <div class="card">
          <h4>Quick Crop Tip</h4>
          <div class="list">
            <div class="scheme">
              <strong>Paddy (Rice)</strong>
              <div class="muted" style="margin-top:6px">Sowing window (Kerala): Jun - Jul. Use 100 kg N/ha in split doses. Watch for blast disease after heavy rains.</div>
            </div>
            <div class="scheme">
              <strong>Coconut</strong>
              <div class="muted" style="margin-top:6px">Apply 500g N + 250g K per palm annually. Mulch and maintain drainage.</div>
            </div>
          </div>
        </div>

        <div class="card">
          <h4>Active Schemes</h4>
          <div class="list">
            <div class="scheme"><strong>PM-Kisan</strong><div class="muted">Income support for small farmers. Check eligibility and enrollment.</div></div>
            <div class="scheme"><strong>FPO Support</strong><div class="muted">Grants for Farmer Producer Organisations ‚Äî link to local KVK.</div></div>
          </div>
        </div>
      </aside>
    </section>

    <footer>  BY ALGOFORGE </footer>
  </main>

  <script>
    /* ---------- Configuration (edit before using live) ---------- */
    // For live weather integration, sign up at OpenWeatherMap and paste your API key here.
    // const OPENWEATHER_API_KEY = 'YOUR_OPENWEATHERMAP_API_KEY';
    const OPENWEATHER_API_KEY = '';

    /* ---------- DOM refs ---------- */
    const micBtn = document.getElementById('micBtn');
    const micIcon = document.getElementById('micIcon');
    const transcriptEl = document.getElementById('transcript');
    const responseEl = document.getElementById('response');
    const responseText = document.getElementById('responseText');
    const responseChips = document.getElementById('responseChips');
    const langSelect = document.getElementById('langSelect');
    const playResp = document.getElementById('playResp');
    const clearBtn = document.getElementById('clearBtn');

    const cityInput = document.getElementById('cityInput');
    const getWeather = document.getElementById('getWeather');
    const weatherPlace = document.getElementById('weatherPlace');
    const weatherSummary = document.getElementById('weatherSummary');
    const weatherIcon = document.getElementById('weatherIcon');

    /* ---------- Speech recognition (Web Speech API) ---------- */
    let recognition = null;
    let isRecording = false;

    function setupRecognition(){
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if(!SpeechRecognition) return null;
      const rec = new SpeechRecognition();
      rec.lang = langSelect.value || 'en-IN';
      rec.interimResults = true;
      rec.maxAlternatives = 1;
      rec.onresult = onSpeechResult;
      rec.onend = ()=>{
        // stop visual state
        isRecording = false; micBtn.classList.remove('recording'); micBtn.setAttribute('aria-pressed','false');
      };
      rec.onerror = (e)=>{
        console.error('Recognition error', e);
        isRecording = false; micBtn.classList.remove('recording'); micBtn.setAttribute('aria-pressed','false');
      };
      return rec;
    }

    function onSpeechResult(e){
      const text = Array.from(e.results).map(r=>r[0].transcript).join('');
      transcriptEl.textContent = text;
      // when final transcript arrives, optionally call the mock handler
      if(e.results[0].isFinal){
        handleQuery(text);
      }
    }

    // init
    recognition = setupRecognition();

    // mic button toggle
    micBtn.addEventListener('click', ()=>{
      if(!recognition){
        alert('Speech Recognition not supported in this browser. Use Chrome on desktop or Android.');
        return;
      }
      if(!isRecording){
        recognition.lang = langSelect.value || 'en-IN';
        recognition.start();
        isRecording = true; micBtn.classList.add('recording'); micBtn.setAttribute('aria-pressed','true');
        transcriptEl.textContent = 'Listening...';
      } else {
        recognition.stop(); // triggers onend and onresult final
      }
    });

    clearBtn.addEventListener('click', ()=>{
      transcriptEl.textContent = 'Press the mic and speak ‚Äî your transcript will appear here.';
      responseEl.hidden = true; responseText.textContent = '';
      responseChips.innerHTML = '';
    });

    /* ---------- Query handling (frontend mock) ---------- */
    function handleQuery(text){
      const q = text.trim().toLowerCase();
      // simple intent heuristics ‚Äî replace with server call in production
      if(!q){ showResponse('Sorry, I did not catch that. Please try again.'); return; }

      if(q.includes('weather') || q.includes('temperature') || q.includes('climate')){
        const city = extractCity(q) || cityInput.value || '';
        if(city) {
          fetchWeather(city);
          return;
        } else {
          showResponse('Please tell me the place name (for example: Thrissur, Kochi).');
          return;
        }
      }

      if(q.includes('sow') || q.includes('when') || q.includes('plant') || q.includes('sowing')){
        // sample rule-based reply
        showResponse('For paddy (rice) in Kerala: sowing window is usually June‚ÄìJuly. Prepare nursery 3 weeks earlier. For specific guidance, provide crop & district.');
        addChips(['Paddy', 'Sowing: Jun-Jul', 'Nursery prep']);
        return;
      }

      if(q.includes('scheme') || q.includes('subsidy') || q.includes('pm-kisan')){
        showResponse('You can check PM-Kisan for income support (visit your local agriculture office to enroll). For FPO support, contact your nearest KVK.');
        addChips(['PM-Kisan','FPO Support']);
        return;
      }

      // default fallback ‚Äî friendly conversational reply
      showResponse('I can help with weather, crop tips and government schemes. Try: "weather in Thrissur" or "when to sow paddy".');
      addChips(['Weather','Crop Tips','Schemes']);
    }

    function extractCity(text){
      // naive city extraction: look for 'in <city>' or 'at <city>' patterns
      const m = text.match(/\bin\s+([a-zA-Z\s]+)/) || text.match(/\bat\s+([a-zA-Z\s]+)/);
      if(m) return m[1].trim();
      return null;
    }

    function showResponse(txt){
      responseEl.hidden = false; responseText.textContent = txt;
      // auto-generate simple speech
      speakText(txt);
    }

    function addChips(items){ responseChips.innerHTML = ''; items.forEach(i=>{ const c = document.createElement('div'); c.className='chip'; c.textContent=i; responseChips.appendChild(c); }); }

    /* ---------- TTS: browser speechSynthesis ---------- */
    function speakText(txt){
      if(!window.speechSynthesis) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(txt);
      // map selected language to voices
      const lang = langSelect.value || 'en-IN';
      u.lang = lang;
      // pick a matching voice if available
      const voices = window.speechSynthesis.getVoices();
      const v = voices.find(v=>v.lang && v.lang.startsWith(lang.split('-')[0]));
      if(v) u.voice = v;
      window.speechSynthesis.speak(u);
    }

    playResp.addEventListener('click', ()=>{
      const txt = responseText.textContent || transcriptEl.textContent;
      if(txt) speakText(txt);
    });

    /* ---------- Weather (OpenWeatherMap simple fetch) ---------- */
    async function fetchWeather(city){
      if(!OPENWEATHER_API_KEY){
        showResponse('Weather demo: API key not set. Enter a city and set OPENWEATHER_API_KEY to fetch live weather.');
        return;
      }
      try{
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&units=metric&appid=${OPENWEATHER_API_KEY}`;
        const res = await fetch(url);
        if(!res.ok) throw new Error('Location not found');
        const j = await res.json();
        const place = `${j.name}, ${j.sys.country}`;
        const summary = `${Math.round(j.main.temp)}¬∞C ‚Ä¢ ${j.weather[0].description}`;
        weatherPlace.textContent = place;
        weatherSummary.textContent = summary;
        weatherIcon.textContent = mapWeatherIcon(j.weather[0].main);
        showResponse(`Weather in ${place}: ${summary}.`);
        addChips([`${Math.round(j.main.temp)}¬∞C`, j.weather[0].main, `Humidity ${j.main.humidity}%`]);
      }catch(err){
        console.error(err); showResponse('Sorry, could not fetch weather for that location.');
      }
    }

    function mapWeatherIcon(main){
      switch(main.toLowerCase()){
        case 'clear': return '‚òÄÔ∏è';
        case 'clouds': return '‚òÅÔ∏è';
        case 'rain': case 'drizzle': return 'üåßÔ∏è';
        case 'thunderstorm': return '‚õàÔ∏è';
        case 'snow': return '‚ùÑÔ∏è';
        default: return 'üå§Ô∏è';
      }
    }

    getWeather.addEventListener('click', ()=>{
      const city = cityInput.value.trim(); if(city) fetchWeather(city); else alert('Enter a city or village name');
    });

    /* ---------- Small niceties: preload voices, keyboard enter ---------- */
    window.speechSynthesis && window.speechSynthesis.onvoiceschanged!==undefined && window.speechSynthesis.onvoiceschanged();
    cityInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ getWeather.click(); } });

    // graceful message when speech API unavailable
    if(!window.SpeechRecognition && !window.webkitSpeechRecognition){
      transcriptEl.textContent = 'Speech recognition not supported in this browser. Use Chrome (desktop or Android) for demo.';
    }
  </script>
</body>
</html>
